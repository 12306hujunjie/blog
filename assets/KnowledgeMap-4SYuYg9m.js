import{_ as K,c as k,o as _,a as u,d as M,f as x,v as L,F as T,g as z,t as B,h as P,i as p,j as V,n as Q}from"./app--xDOKwpD.js";const U={name:"KnowledgeMap",setup(){const b=p(""),s=p(""),m=p([]),o=p([]),v=p([]);let g=null;const t=p([]),h=p(null),N=async()=>{var n,l,c;try{const e=["./knowledge-data.json","/blog/knowledge-data.json","/knowledge-data.json"],a=(n=document.querySelector("base"))==null?void 0:n.getAttribute("href");a&&e.unshift(`${a}knowledge-data.json`.replace("//","/")),console.log("尝试加载数据，候选路径:",e);for(const d of e)try{const i=await fetch(d);if(i.ok){const r=await i.json();console.log("成功从",d,"加载数据，节点数量:",(l=r.nodes)==null?void 0:l.length,"边数量:",(c=r.edges)==null?void 0:c.length),h.value=r,t.value=r.articles||[];return}}catch(i){console.log("尝试",d,"失败:",i.message)}console.warn("所有数据加载路径都失败，使用默认数据"),t.value=D()}catch(e){console.warn("加载知识地图数据失败，使用默认数据:",e),t.value=D()}},D=()=>[{id:"bitwise_operation",title:"位运算技巧",category:"algorithm",tags:["位运算","最佳实践"],path:"/blogs/algorithm/bitwise_operation.html"},{id:"sort_1",title:"排序算法详解",category:"algorithm",tags:["排序"],path:"/blogs/algorithm/array/sort_1.html"},{id:"cache_pattern",title:"缓存模式",category:"cache",tags:["缓存","最佳实践"],path:"/blogs/cache/cache_pattern.html"},{id:"docker_tech",title:"Docker技术",category:"cloud-base",tags:["docker","容器"],path:"/blogs/cloud-base/docker_tech.html"},{id:"k3s",title:"K3S轻量级Kubernetes",category:"cloud-base",tags:["k3s","k8s"],path:"/blogs/cloud-base/k3s.html"},{id:"linux_namespace",title:"Linux命名空间",category:"linux",tags:["linux","虚拟化"],path:"/blogs/linux/linux_namespace.html"},{id:"gevent",title:"Gevent源码解析",category:"python-web",tags:["源码解析","flask框架"],path:"/blogs/python-web/gevent.html"},{id:"python_checklist",title:"Python开发清单",category:"python",tags:["checklist"],path:"/blogs/python/python_checklist.html"},{id:"python_env_manage",title:"Python环境管理",category:"python",tags:["环境管理","poetry"],path:"/blogs/python/python_env_manage.html"}],j=()=>{if(!t.value||t.value.length===0)return{nodes:[],edges:[]};if(h.value)return o.value=h.value.nodes,v.value=h.value.edges,m.value=[...new Set(h.value.articles.map(e=>e.category))],{nodes:h.value.nodes,edges:h.value.edges};const n=[],l=[],c={algorithm:"#ff6b6b",cache:"#4ecdc4","cloud-base":"#45b7d1",linux:"#96ceb4","python-web":"#feca57",python:"#ff9ff3",design_pattern:"#54a0ff",编程基础:"#54a0ff",项目说明:"#95a5a6",uncategorized:"#95a5a6"};t.value.forEach(e=>{n.push({id:e.id,label:e.title,title:`分类: ${e.category}
标签: ${e.tags.join(", ")}
点击查看详情`,color:c[e.category]||"#95a5a6",category:e.category,tags:e.tags,path:e.path,physics:!0})});for(let e=0;e<t.value.length;e++)for(let a=e+1;a<t.value.length;a++){const d=t.value[e],i=t.value[a];let r=0;d.category===i.category&&(r+=4);const f=d.tags.filter(w=>i.tags.includes(w)),y=["最佳实践","checklist","工具","教程"],S=f.filter(w=>!y.includes(w));r+=S.length*3,r+=(f.length-S.length)*1,r>=3&&l.push({from:d.id,to:i.id,width:Math.min(r,5),length:200-r*20,title:`关联强度: ${r}
共同标签: ${f.join(", ")}`})}return o.value=n,v.value=l,m.value=[...new Set(t.value.map(e=>e.category))],{nodes:n,edges:l}},C=()=>{if(typeof window>"u")return;const n=document.createElement("script");n.src="https://unpkg.com/vis-network@latest/dist/vis-network.min.js",n.onload=()=>{const{nodes:l,edges:c}=j(),e=document.getElementById("knowledge-network");if(!e)return;const a={nodes:new vis.DataSet(l),edges:new vis.DataSet(c)},d={physics:{stabilization:{iterations:100},barnesHut:{gravitationalConstant:-8e3,springConstant:.001,springLength:200}},interaction:{hover:!0,tooltipDelay:300},nodes:{shape:"dot",size:15,font:{size:12,color:"#333"},borderWidth:2,shadow:!0},edges:{color:{inherit:"from"},smooth:{type:"continuous"}}};g=new vis.Network(e,a,d),g.on("click",i=>{if(i.nodes.length>0){const r=i.nodes[0],f=t.value.find(y=>y.id===r);f&&window.open(f.path,"_blank")}})},document.head.appendChild(n)},E=()=>{if(!g)return;const n=b.value?o.value.filter(e=>e.category===b.value):o.value,l=new Set(n.map(e=>e.id)),c=v.value.filter(e=>l.has(e.from)&&l.has(e.to));g.setData({nodes:new vis.DataSet(n),edges:new vis.DataSet(c)})},I=()=>{if(!g)return;const n=s.value.toLowerCase();if(!n){g.setData({nodes:new vis.DataSet(o.value),edges:new vis.DataSet(v.value)});return}const l=o.value.filter(a=>a.label.toLowerCase().includes(n)),c=new Set(l.map(a=>a.id)),e=v.value.filter(a=>c.has(a.from)||c.has(a.to));e.forEach(a=>{if(!c.has(a.from)){const d=o.value.find(i=>i.id===a.from);d&&l.push(d)}if(!c.has(a.to)){const d=o.value.find(i=>i.id===a.to);d&&l.push(d)}}),g.setData({nodes:new vis.DataSet(l),edges:new vis.DataSet(e)})};return V(async()=>{await N(),Q(()=>{C()})}),{selectedCategory:b,searchQuery:s,categories:m,filterNodes:E,searchNodes:I}}},q={class:"knowledge-map"},F={class:"map-controls"},G={class:"filter-section"},A=["value"],H={class:"search-section"};function W(b,s,m,o,v,g){return _(),k("div",q,[u("div",F,[u("div",G,[s[5]||(s[5]=u("label",null,"筛选分类：",-1)),x(u("select",{"onUpdate:modelValue":s[0]||(s[0]=t=>o.selectedCategory=t),onChange:s[1]||(s[1]=(...t)=>o.filterNodes&&o.filterNodes(...t))},[s[4]||(s[4]=u("option",{value:""},"全部",-1)),(_(!0),k(T,null,z(o.categories,t=>(_(),k("option",{key:t,value:t},B(t),9,A))),128))],544),[[L,o.selectedCategory]])]),u("div",H,[x(u("input",{"onUpdate:modelValue":s[2]||(s[2]=t=>o.searchQuery=t),onInput:s[3]||(s[3]=(...t)=>o.searchNodes&&o.searchNodes(...t)),placeholder:"搜索文章标题...",class:"search-input"},null,544),[[P,o.searchQuery]])])]),s[6]||(s[6]=M('<div id="knowledge-network" class="network-container" data-v-88daabb3></div><div class="map-legend" data-v-88daabb3><h4 data-v-88daabb3>图例说明</h4><div class="legend-item" data-v-88daabb3><span class="node-example algorithm" data-v-88daabb3></span><span data-v-88daabb3>算法类</span></div><div class="legend-item" data-v-88daabb3><span class="node-example python" data-v-88daabb3></span><span data-v-88daabb3>Python类</span></div><div class="legend-item" data-v-88daabb3><span class="node-example cloud-base" data-v-88daabb3></span><span data-v-88daabb3>云原生类</span></div><div class="legend-item" data-v-88daabb3><span class="node-example other" data-v-88daabb3></span><span data-v-88daabb3>其他类别</span></div></div>',2))])}const O=K(U,[["render",W],["__scopeId","data-v-88daabb3"]]);export{O as default};
